(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7484:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return R}});var t=r(5893),o=r(4121),i=r(6265);function c(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?c(Object(r),!0).forEach((function(n){(0,i.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var s=function(e){var n=e.props,r=e.color;return(0,t.jsxs)("mesh",a(a({},n),{},{children:[(0,t.jsx)("coneGeometry",{args:[.1,.4]}),(0,t.jsx)("meshBasicMaterial",{color:r})]}))},u=r(1834);function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function f(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){(0,i.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var p,m=function(e){return new u.Vector3(e.x,-e.y,e.z)},d={13:"LeftArm",15:"LeftForeArm",17:"LeftHand"},v=Object.fromEntries(Object.entries(d).map((function(e){var n=(0,o.Z)(e,2),r=n[0],t=n[1];return[r,"mixamorig".concat(t)]}))),j=Object.fromEntries(Object.entries(v).map((function(e){var n=(0,o.Z)(e,2),r=n[0],t=n[1];return[Number(r)+1,t.replace("Left","Right")]}))),h=f(f({},v),j),b=f(f({},(p=h,Object.fromEntries(Object.entries(p).map((function(e){var n=(0,o.Z)(e,2),r=n[0];return[n[1],r]}))))),{},{LeftShoulder:"11",RightShoulder:"12"}),g=r(809),O=r.n(g),y=r(2447),w=r(9999),x=r(7135),P=r(264),k=r(7294),E=r(5769),S=r(9088),_=r(2401),F=r(5648),D=new u.Vector3(.02,.02,.02),L=function(e){var n=e.landmarks,r=(0,E.m)("stacy.jpg"),i=(0,S.L)("dancer.glb","/").nodes,c=i.Beta_Surface;return(0,k.useEffect)((function(){!function(e,n){Object.entries(h).map((function(r){var t=(0,o.Z)(r,2),i=t[0],c=t[1],a=e[Number(i)],s=n[c];if(s){var l,f,p=null!==s&&void 0!==s&&null!==(l=s.parent)&&void 0!==l&&l.name?e[Number(b[s.parent.name])]:{x:0,y:0,z:0},d=m(a),v=m(null!==p&&void 0!==p?p:{x:0,y:0,z:0}),j=((new u.Euler).setFromVector3(v.sub(d)),new u.Quaternion);null===(f=s.parent)||void 0===f||f.getWorldQuaternion(j);var h=v.sub(d),g=(new u.Quaternion).setFromUnitVectors(new u.Vector3(0,1,0),h.clone().normalize()).clone().multiply(new u.Quaternion(.5110536,0,.5110536,.6911211));if(c.includes("Left")){var O;null===(O=s.parent)||void 0===O||O.getWorldQuaternion(j);var y=j.clone().invert().multiply(g).multiply(new u.Quaternion(0,-1,0,0));s.setRotationFromQuaternion(y)}else{var w;null===(w=s.parent)||void 0===w||w.getWorldQuaternion(j);var x=j.clone().invert().multiply(g);s.setRotationFromQuaternion(x)}}}))}(n,i)}),[n]),(0,t.jsx)("group",{dispose:null,children:"geometry"in c?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("group",{rotation:[Math.PI/2,0,Math.PI],scale:D,children:[(0,t.jsx)("primitive",{object:i.mixamorigHips}),(0,t.jsx)("skinnedMesh",{receiveShadow:!0,castShadow:!0,geometry:c.geometry,skeleton:c.skeleton,children:(0,t.jsx)("meshBasicMaterial",{map:r,"map-flipY":!1,skinning:!0})})]})}):null})},Q=function(){var e=(0,F.Ky)().camera;return(0,t.jsx)(_.z,{camera:e})},N=function(e){var n=e.landmarks;return(0,t.jsx)(t.Fragment,{children:(null===n||void 0===n?void 0:n.length)&&n.map((function(e,r){if("x"in e){var o=e.x,i=e.y,c=e.z,a=r in d?"red":"blue",l=m(e),f=m(n[r-2]?n[r-2]:e),p=(new u.Euler).setFromVector3(f.sub(l).multiplyScalar(-1));return(0,t.jsx)(s,{props:{position:[o,-i,c],rotation:p},color:a},r)}}))})};function R(){var e=(0,k.useRef)(null);(0,k.useEffect)((function(){navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then((function(n){e.current&&(e.current.srcObject=n)})).catch((function(e){console.log("Something went wrong!"),console.log(e)}))}),[]);var n=function(e){var n=e.videoRef,r=(0,k.useState)(null),t=r[0],o=r[1];return(0,k.useEffect)((function(){var e=n.current,r=new P.Pose({locateFile:function(e){return"https://cdn.jsdelivr.net/npm/@mediapipe/pose/".concat(e)}});r.setOptions({modelComplexity:1,smoothLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),r.onResults((function(e){e.poseLandmarks&&o((0,w.Z)(e.poseLandmarks))})),e&&new x.Camera(e,{onFrame:function(){var n=(0,y.Z)(O().mark((function n(){return O().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.send({image:e});case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),width:1280,height:720}).start()}),[n]),t}({videoRef:e});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(F.Xz,{style:{height:"70vh"},children:[(0,t.jsx)(k.Suspense,{fallback:null,children:n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L,{landmarks:n}),(0,t.jsx)(N,{landmarks:n})]})}),(0,t.jsx)(Q,{})]}),(0,t.jsx)("video",{autoPlay:!0,ref:e,width:300})]})}},5301:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(7484)}])}},function(e){e.O(0,[774,737,205,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);